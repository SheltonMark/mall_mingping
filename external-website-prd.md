# LEMOPX 外网站点 - 产品需求文档 (PRD)

**版本**: v1.0
**日期**: 2025-11-07
**项目代号**: LEMOPX External Site

---

## 📋 项目概述

### 项目背景

客户需要将现有电商系统拆分为两个独立站点：

- **内网站点**：部署在客户公司内网，连接ERP数据库，供员工使用
- **外网站点**：本文档描述的新系统，面向国内外客户，提供产品展示和订单咨询功能

### 核心定位

**展示型电商平台** - 重点在于产品展示和订单信息收集，不涉及实际交易和支付

### 关键特点

- ✅ 国内外客户统一体验（无地域差异）
- ✅ 游客可见价格
- ✅ 客户注册无需审核
- ✅ 完整产品规格系统（组件级别颜色选择）
- ✅ 购物车功能
- ✅ 订单表单提交（仅收集信息，不处理订单）
- ❌ 不支持在线支付
- ❌ 不进行订单处理和发货
- ❌ 不需要SEO优化
- ❌ 不区分国内外用户

---

## 🎯 用户角色

### 1. 游客 (Guest)

**权限**:

- ✅ 浏览所有产品
- ✅ 查看产品详情和价格
- ✅ 搜索和筛选产品
- ❌ 无法添加购物车
- ❌ 无法提交订单表单

### 2. 注册客户 (Registered Customer)

**注册方式**:

- 填写注册表单即可，系统自动通过，无需管理员审核

**权限**:

- ✅ 游客所有权限
- ✅ 添加产品到购物车
- ✅ 提交订单表单
- ✅ 查看自己提交的订单表单历史
- ✅ 管理个人资料
- ❌ 无法修改或删除已提交的订单表单

### 3. 管理员/员工 (Admin/Staff)

**权限**:

- ✅ 产品管理（上传、编辑、删除）
- ✅ 组件颜色管理
- ✅ 查看所有客户提交的订单表单
- ✅ 导出订单表单数据
- ✅ 客户管理
- ❌ 不需要订单审核功能（仅查看）

---

## 🏗️ 系统架构

### 技术栈（复用现有）

```
前端: Next.js 14.2.33 (App Router)
后端: NestJS
数据库: MySQL 8.0
ORM: Prisma
语言: TypeScript
国际化: 中文 + 英文
```

### 数据独立性

- **完全独立的数据库**：与内网站点无任何数据同步
- **独立的用户系统**：客户、产品、订单数据完全独立
- **独立部署**：运行在阿里云服务器（当前已有）

### UI/UX复用

- ✅ 复用现有设计风格和组件
- ✅ 复用布局结构
- ✅ 简化功能流程（移除支付、订单处理等复杂逻辑）

---

## 📦 核心功能模块

## 1. 产品展示模块

### 1.1 产品列表页

**功能**:

- 产品卡片展示（图片、名称、型号、价格）
- 分类筛选
- 关键词搜索
- 分页加载

**游客可见**: ✅ 是
**显示价格**: ✅ 是

### 1.2 产品详情页

**功能**:

- 产品基本信息（名称、型号、描述）
- 产品图片轮播
- **完整规格系统**:
  - 组件列表（Base/Grips/Triggers/Buttons等）
  - 每个组件的颜色选择（下拉或色块选择）
  - 实时价格计算（如不同颜色有价差）
- 数量选择
- 添加购物车按钮（需登录）

**颜色管理**:

- 管理员在后台为每个组件添加可用颜色
- 前端根据配置动态显示颜色选项
- 不需要色卡转换功能

### 1.3 购物车

**功能**:

- 查看已添加产品
- 显示配置详情（各组件颜色）
- 调整数量
- 删除产品
- 查看总金额
- "提交订单表单"按钮

**注意**: 这里的"总金额"仅供参考，不涉及实际支付

---

## 2. 客户账户模块

### 2.1 客户注册

**注册字段**:

- 邮箱 (必填，唯一)
- 密码 (必填)
- 公司名称 (必填)
- 联系人姓名 (必填)
- 电话 (必填)
- 国家/地区 (选填)
- 地址 (选填)

**注册流程**:

1. 填写注册表单
2. 提交 → 系统自动通过
3. 自动登录或跳转登录页

**无需**:

- ❌ 管理员审核
- ❌ 邮箱验证（可选功能，暂不实现）

### 2.2 客户登录

**登录方式**:

- 邮箱 + 密码

**功能**:

- 记住登录状态（JWT token）
- 忘记密码（可选，暂不实现）

### 2.3 个人中心

**功能**:

- 查看/编辑个人资料
- 查看已提交订单表单历史
- 查看订单表单详情

---

## 3. 订单表单模块

### 3.1 订单表单提交

**流程**:

1. 客户在购物车点击"提交订单表单"
2. 填写/确认收货信息:
   - 联系人
   - 电话
   - 邮箱
   - 地址
   - 备注
3. 提交成功 → 显示"已收到您的咨询，我们会尽快联系您"

**数据存储**:

- 保存客户信息
- 保存购物车内容（产品+配置+数量）
- 保存总金额
- 生成表单编号

**状态**:

- 固定状态：`submitted`（已提交）
- 不需要"待处理/处理中/已完成"等状态流转

### 3.2 订单表单历史（客户端）

**功能**:

- 客户查看自己提交的所有表单
- 显示：表单编号、提交时间、产品列表、总金额
- 查看详情

**限制**:

- ❌ 不能修改
- ❌ 不能删除
- ❌ 不能取消

### 3.3 订单表单管理（后台）

**功能**:

- 查看所有客户提交的订单表单
- 筛选（按时间、客户、状态）
- 搜索（客户名称、表单编号）
- 查看详情（客户信息 + 产品配置详情）
- 导出Excel（可选功能）

**不需要**:

- ❌ 审核功能
- ❌ 发货功能
- ❌ 状态修改
- ❌ 订单处理流程

---

## 4. 后台管理模块

### 4.1 产品管理

**功能**:

- 产品列表（支持搜索、分页）
- 添加产品:
  - 基本信息（名称、型号、描述、价格）
  - 产品图片上传（多图）
  - 分类选择
  - 组件配置（Base/Grips/Triggers/Buttons等）
  - 为每个组件配置可用颜色
- 编辑产品
- 删除产品
- 上架/下架

**颜色配置方式**:

```
示例：
产品: Xbox Controller Pro

组件配置:
┌─────────────────────────────────┐
│ Base (手柄主体)                  │
│ 可选颜色:                        │
│  □ 黑色 (#000000)               │
│  □ 白色 (#FFFFFF)               │
│  □ 红色 (#FF0000)               │
│  [+ 添加颜色]                    │
├─────────────────────────────────┤
│ Grips (握把)                    │
│ 可选颜色:                        │
│  □ 黑色 (#000000)               │
│  □ 灰色 (#808080)               │
│  [+ 添加颜色]                    │
└─────────────────────────────────┘
```

### 4.2 颜色库管理

**功能**:

- 全局颜色库（预定义常用颜色）
- 添加颜色:
  - 颜色名称（中文 + 英文）
  - 颜色代码（HEX）
  - 颜色图片（可选，用于材质展示）
- 编辑/删除颜色

**使用方式**:

- 添加产品时，从颜色库选择，或临时添加新颜色
- 新添加的颜色自动加入颜色库供后续使用

### 4.3 客户管理

**功能**:

- 查看所有注册客户
- 筛选和搜索
- 查看客户详情
- 禁用/启用账户（可选）

**不需要**:

- ❌ 客户审核功能（注册自动通过）

### 4.4 分类管理

**功能**:

- 产品分类列表
- 添加/编辑/删除分类
- 分类排序

---

## 📊 数据库设计要点

### 核心表

#### `products` (产品表)

```
id, name_zh, name_en, model, description_zh, description_en,
price, category_id, images (JSON), status, created_at, updated_at
```

#### `product_components` (产品组件配置表)

```
id, product_id, component_name_zh, component_name_en,
component_type (base/grips/triggers/buttons/etc),
available_colors (JSON array of color IDs), created_at
```

#### `colors` (颜色库表)

```
id, name_zh, name_en, hex_code, image_url, created_at
```

#### `customers` (客户表)

```
id, email, password_hash, company, contact_name, phone,
country, address, status (active/disabled), created_at, updated_at
```

#### `order_forms` (订单表单表)

```
id, customer_id, form_number (自动生成),
contact_name, phone, email, address, notes,
items (JSON), total_amount, status (submitted),
submitted_at, created_at
```

**`items` JSON 结构示例**:

```json
[
  {
    "product_id": "123",
    "product_name": "Xbox Controller Pro",
    "quantity": 2,
    "unit_price": 299.00,
    "configuration": {
      "base": { "color_id": "1", "color_name": "黑色" },
      "grips": { "color_id": "5", "color_name": "红色" },
      "triggers": { "color_id": "1", "color_name": "黑色" }
    }
  }
]
```

---

## 🌍 国际化 (i18n)

### 支持语言

- 中文（简体）- 默认
- 英文

### 翻译范围

- ✅ 界面文字
- ✅ 产品名称、描述（数据库双语字段）
- ✅ 分类名称
- ✅ 组件名称
- ✅ 颜色名称
- ❌ 不需要其他语言

### 实现方式

- 使用 `next-intl` 或类似库
- URL 路由: `/zh`, `/en`
- 语言切换器（页面右上角）

---

## 🚫 明确排除功能

以下功能**不包含**在本项目中:

1. ❌ **在线支付**: 无需集成任何支付网关
2. ❌ **订单处理**: 无需订单状态流转、发货、物流跟踪
3. ❌ **库存管理**: 无需库存扣减、预警等
4. ❌ **价格管理**: 产品价格固定，无需促销、折扣系统
5. ❌ **评论/评价**: 无需产品评论功能
6. ❌ **优惠券**: 无需优惠券系统
7. ❌ **积分/会员等级**: 无需会员体系
8. ❌ **SEO优化**: 无需特别的SEO配置
9. ❌ **CDN加速**: 暂不需要
10. ❌ **邮箱验证**: 注册无需邮箱验证
11. ❌ **订单表单编辑**: 客户提交后不可修改
12. ❌ **地域区分**: 国内外客户功能完全一致

---

## 🎨 UI/UX 要求

### 设计风格

- 复用现有设计（干净、现代、专业）
- 色调：黑白灰为主，品牌色点缀
- 响应式设计（桌面 + 移动端）

### 关键页面布局

#### 首页

- Hero Banner
- 产品分类导航
- 精选产品展示
- 关于公司简介

#### 产品列表页

- 左侧：分类筛选
- 右侧：产品网格（卡片式）
- 顶部：搜索栏

#### 产品详情页

- 左侧：产品图片轮播
- 右侧：
  - 产品名称、型号
  - 价格
  - 组件颜色选择（可展开/收起）
  - 数量选择
  - 添加购物车按钮
- 底部：产品描述（标签页：详情、规格）

#### 购物车

- 列表式展示
- 每项显示：产品图、名称、配置、数量、小计
- 底部：总计、提交订单表单按钮

#### 后台产品管理

- 表格列表 + 操作按钮
- 添加/编辑：表单式，分步骤（基本信息 → 组件配置 → 图片上传）

---

## 📱 响应式要求

### 断点

- 移动端: < 768px
- 平板: 768px - 1024px
- 桌面: > 1024px

### 移动端优化

- 导航栏折叠为汉堡菜单
- 产品列表改为单列
- 产品详情组件选择改为下拉框（节省空间）
- 购物车适配小屏幕

---

## 🔐 安全要求

### 身份认证

- JWT token 验证
- 密码加密存储（bcrypt）
- HTTPS 连接（Let's Encrypt）

### 权限控制

- 游客只能浏览
- 客户只能访问自己的数据
- 管理员 API 需验证管理员权限

### 数据验证

- 前后端双重验证
- SQL注入防护（Prisma自动处理）
- XSS防护

---

## 📈 性能要求

### 页面加载

- 首屏加载 < 3秒
- 产品列表分页（每页20-30条）
- 图片懒加载

### 数据库优化

- 产品查询索引
- 分页查询
- 图片存储：阿里云OSS（可选）或本地 /uploads

### 缓存策略

- 产品列表缓存（可选）
- 静态资源缓存

---

## 🧪 测试要求

### 功能测试

- [ ] 游客浏览产品（含价格显示）
- [ ] 客户注册（自动通过）
- [ ] 客户登录
- [ ] 添加产品到购物车（含颜色配置）
- [ ] 提交订单表单
- [ ] 查看订单表单历史
- [ ] 管理员添加产品（含组件颜色配置）
- [ ] 管理员查看订单表单
- [ ] 中英文切换

### 兼容性测试

- Chrome, Firefox, Safari, Edge
- iOS Safari, Android Chrome
- 不同屏幕尺寸

---

## 📅 开发阶段

### 阶段一：数据库设计 (1天)

- [ ] 设计所有表结构
- [ ] 编写 Prisma Schema
- [ ] 运行数据库迁移
- [ ] 创建测试数据

### 阶段二：后端API开发 (3-4天)

- [ ] 产品相关API（CRUD + 组件颜色配置）
- [ ] 客户注册/登录API
- [ ] 购物车API
- [ ] 订单表单API
- [ ] 后台管理API
- [ ] 颜色库API

### 阶段三：前端页面开发 (4-5天)

- [ ] 首页
- [ ] 产品列表页
- [ ] 产品详情页（含组件颜色选择）
- [ ] 购物车页面
- [ ] 客户注册/登录页面
- [ ] 个人中心
- [ ] 订单表单历史
- [ ] 国际化集成

### 阶段四：后台管理界面 (3-4天)

- [ ] 产品管理（含组件颜色配置界面）
- [ ] 颜色库管理
- [ ] 订单表单查看
- [ ] 客户管理
- [ ] 分类管理

### 阶段五：测试和优化 (2天)

- [ ] 功能测试
- [ ] UI/UX优化
- [ ] 性能优化
- [ ] Bug修复

### 阶段六：部署上线 (1天)

- [ ] 阿里云服务器部署
- [ ] 域名配置
- [ ] SSL证书配置
- [ ] 最终测试

**总开发时间：约14-17个工作日（3周左右）**

---

## 🚀 部署方案

### 服务器

- 阿里云 ECS（当前已有）
- 配置: 2核4GB（足够）
- 系统: Ubuntu 22.04 LTS

### 域名

- 使用新域名或子域名（区别于内网站点）
- 示例: `www.lemopx.com` 或 `shop.lemopx.com`

### 技术栈

- Nginx: 反向代理
- PM2: Node.js进程管理
- MySQL 8.0: 数据库
- Let's Encrypt: SSL证书

### 备份策略

- 数据库每日备份
- 上传文件定期备份

---

## 📞 项目交付物

### 代码

- ✅ 前端代码（Next.js）
- ✅ 后端代码（NestJS）
- ✅ 数据库Schema和迁移文件
- ✅ README 部署文档

### 文档

- ✅ API接口文档
- ✅ 数据库设计文档
- ✅ 部署指南
- ✅ 用户使用手册（可选）

### 部署

- ✅ 生产环境部署
- ✅ SSL证书配置
- ✅ 域名解析

---

## ✅ 验收标准

### 功能完整性

- [ ] 所有核心功能正常运行
- [ ] 游客、客户、管理员三种角色权限正确
- [ ] 组件级颜色选择功能正常
- [ ] 订单表单提交和查看正常
- [ ] 中英文切换正常

### 性能指标

- [ ] 页面加载速度 < 3秒
- [ ] 支持10个并发用户无压力

### 安全性

- [ ] HTTPS连接
- [ ] 密码加密
- [ ] API权限验证

### 兼容性

- [ ] 主流浏览器正常显示
- [ ] 移动端响应式正常

更新todo:



 当前后台点击新增sku只能选择分类 （这个其实没问题 只是说是否需要新增分类管理 如果需要 放哪里 产品管理内部还是 新增一个模块 ）我建议单独搞个模块 现在的产品管理 再xxx系列右边有显示分类 这个在新增sku的时候 就需要选择（当前的逻辑就是这样的） 然后分类管理要在前端的所有产品页的筛选部分显示分类 （前端页面的筛选 不用显示材料 删除它）  并且这个分类要支持中英文切换（走翻译文件即可）


todo 1.恢复首页logo预加载动画!!!很重要！！！ 之前是有的 新分支没有了 2..产品管理：多颜色逻辑调试

重点调试多组件多颜色配置的前后端联调

需求我再澄清一下  就是可能某些规格是多个组件组合  但是有些组件本身就是个组合 比如 喷塑+塑件  并且这个组合还对应几个颜色组合  有些组件可能就是单个所以我分成 单个组件和组合组件  前端需要显示后台上传的组合组件的名称和对应的一个或多个颜色组合  也可以是单个组件的名称和颜色   这里比较绕 你先输出你梳理的逻辑  再开始调试

前端所有页面支持 中英文一键切换  后台不需要中英文 只需要中文

网站部署 到服务器

---

## 📝 备注

### 与内网站点的区别

| 功能     | 外网站点     | 内网站点     |
| -------- | ------------ | ------------ |
| 用户     | 国内外客户   | 公司员工     |
| 数据库   | 独立数据库   | 连接ERP      |
| 产品管理 | 后台手动上传 | 从ERP同步    |
| 订单处理 | 仅收集表单   | 完整订单流程 |
| 支付     | ❌           | ❌           |
| 库存     | ❌           | ✅           |

### 未来扩展（可选）

- 邮箱验证功能
- 订单表单导出Excel
- 产品收藏功能
- 询盘聊天功能
- 更多语言支持

---

**文档制作**: Claude Code
**最后更新**: 2025-11-07
**状态**: 待客户确认
