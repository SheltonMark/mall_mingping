cd ~/internal_web/mall_mingping_internal/code/backend-api

cat > .env << 'EOF'
DATABASE_URL="mysql://lemopx:1q!@localhost:3306/internal_sales"
JWT_SECRET="HF3suIJ4mHk9OQBwDRAqYqUC9Eaq8HyCabPaXoAx7yI="
PORT=3001
HOST=0.0.0.0
CORS_ORIGIN=*

ERP_SYNC_ENABLED=true
ERP_DB_HOST=192.168.3.254
ERP_DB_PORT=1433
ERP_DB_USER=sa
ERP_DB_PASSWORD=1q!
ERP_DB_NAME=DB_MP01
EOF

cat > .env << 'EOF'
NEXT_PUBLIC_API_URL=http://192.168.13.17:3001/api
EOF


cat > src/main.ts << 'EOF'
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';
import { ValidationPipe } from '@nestjs/common';
import { NestExpressApplication } from '@nestjs/platform-express';
import { join } from 'path';
import { PrismaService } from './prisma.service';

async function bootstrap() {
  const app = await NestFactory.create<NestExpressApplication>(AppModule);

  // Enable CORS
  app.enableCors({
    origin: process.env.CORS_ORIGIN === '*' ? true : (process.env.CORS_ORIGIN ||
'http://localhost:3000').split(','),
    credentials: true,
  });

  // Global validation pipe
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      transform: true,
      forbidNonWhitelisted: true,
      transformOptions: {
        enableImplicitConversion: true,
      },
    }),
  );

  // Serve static files from uploads directory
  app.useStaticAssets(join(__dirname, '..', 'uploads'), {
    prefix: '/uploads/',
  });

  // Set global prefix
  app.setGlobalPrefix('api');

  // Enable shutdown hooks for Prisma
  const prismaService = app.get(PrismaService);
  await prismaService.enableShutdownHooks(app);

  const port = process.env.PORT || 3001;
  const host = process.env.HOST || '0.0.0.0';
  await app.listen(port, host);

  console.log(`üöÄ Server is running on: http://${host}:${port}/api`);
  console.log(`üìÅ Static files served from: /uploads/`);
}
bootstrap();
EOF

netsh interface portproxy add v4tov4 listenport=3000 listenaddress=0.0.0.0 connectport=3000 connectaddress=172.31.15.84

netsh interface portproxy add v4tov4 listenport=3001 listenaddress=0.0.0.0 connectport=3001 connectaddress=172.31.15.84

  # Êü•ÁúãÊòØÂê¶ÊàêÂäü
  netsh interface portproxy show all

  # ÂÖÅËÆ∏Èò≤ÁÅ´Â¢ô
  netsh advfirewall firewall add rule name="WSL 3000" dir=in action=allow protocol=tcp localport=3000
  netsh advfirewall firewall add rule name="WSL 3001" dir=in action=allow protocol=tcp localport=3001
  
  
  
  
  
  
  
cat > /home/lemopx/internal_web/mall_mingping_internal/code/backend-api/src/main.ts << 'EOF'
import { NestFactory } from '@nestjs/core';
import { ValidationPipe } from '@nestjs/common';
import { NestExpressApplication } from '@nestjs/platform-express';
import { join } from 'path';
import { AppModule } from './app.module';
import { PrismaService } from './prisma.service';

async function bootstrap() {
  const app = await NestFactory.create<NestExpressApplication>(AppModule);

  // Enable CORS
  app.enableCors({
    origin: process.env.CORS_ORIGIN === '*' ? true : (process.env.CORS_ORIGIN ||
'http://localhost:3000').split(','),
    credentials: true,
  });

  // Global validation pipe
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      forbidNonWhitelisted: true,
      transform: true,
    }),
  );

  // Serve static files from public directory (for admin UI)
  app.useStaticAssets(join(process.cwd(), 'public'), {
    prefix: '/',
  });

  // Serve static files from uploads directory
  const uploadsDir = process.env.UPLOAD_DIR || './uploads';
  console.log('üìÅ Uploads directory:', join(process.cwd(), uploadsDir));
  app.useStaticAssets(join(process.cwd(), uploadsDir), {
    prefix: '/uploads/',
  });

  // Global prefix (must come after static assets)
  app.setGlobalPrefix('api');

  // Prisma shutdown hook
  const prismaService = app.get(PrismaService);
  await prismaService.enableShutdownHooks(app);

  const port = process.env.PORT || 3001;
  const host = process.env.HOST || '0.0.0.0';
  await app.listen(port, host);

  console.log(`üöÄ Server is running on: http://${host}:${port}/api`);
  console.log(`üìÅ Static files served from: /uploads/`);
}
bootstrap();
EOF


export https_proxy=http://127.0.0.1:33210 http_proxy=http://127.0.0.1:33210 all_proxy=socks5://127.0.0.1:33211


sed -i "s/} from '@nestjs\/common';/} from '@nestjs\/common';\nimport { IsString, IsOptional, IsBoolean, IsNumber, IsArray } from 'class-validator';/" erp.controller.ts



mysql -u lemopx -p'1q!' internal_sales << 'EOF'
CREATE TABLE IF NOT EXISTS `cart_items` (
  `id` varchar(191) NOT NULL,
  `salesperson_id` varchar(191) NOT NULL,
  `sku_id` varchar(191) NOT NULL,
  `product_code` varchar(191) NOT NULL,
  `product_name` varchar(191) NOT NULL,
  `color_scheme` json DEFAULT NULL,
  `quantity` int NOT NULL DEFAULT '1',
  `price` decimal(65,30) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `cart_items_salesperson_id_idx` (`salesperson_id`),
  CONSTRAINT `cart_items_salesperson_id_fkey` FOREIGN KEY (`salesperson_id`) REFERENCES `salespersons` (`id`) ON
DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF



  cd ~/internal_web/mall_mingping_internal/code/backend-api/src/erp

cat > erp.controller.ts << 'EOF'
import {
  Controller,
  Post,
  Get,
  Delete,
  Put,
  Param,
  Body,
  Query,
  UseGuards,
} from '@nestjs/common';
import { IsString, IsOptional, IsBoolean, IsNumber, IsArray } from 'class-validator';
import { ErpOrderSyncService } from './erp-order-sync.service';
import { ErpProductSyncService } from './erp-product-sync.service';
import { JwtAuthGuard } from '../common/guards/jwt-auth.guard';

// DTO ÂÆö‰πâ
class CreateMappingDto {
  @IsString()
  websiteId: string;

  @IsString()
  erpNo: string;
}

class UpdateMappingDto {
  @IsString()
  erpNo: string;
}

class BatchSyncDto {
  @IsArray()
  @IsString({ each: true })
  orderIds: string[];
}

class ProductSyncDto {
  @IsOptional()
  @IsBoolean()
  incremental?: boolean; // ÊòØÂê¶Â¢ûÈáèÂêåÊ≠•ÔºåÈªòËÆ§ true

  @IsOptional()
  @IsNumber()
  days?: number;         // Â¢ûÈáèÂêåÊ≠•Â§©Êï∞ÔºåÈªòËÆ§ 1
}

@Controller('erp')
@UseGuards(JwtAuthGuard)
export class ErpController {
  constructor(
    private readonly erpOrderSyncService: ErpOrderSyncService,
    private readonly erpProductSyncService: ErpProductSyncService,
  ) {}

  // ============ ËÆ¢ÂçïÂêåÊ≠•Êé•Âè£ ============

  /**
   * ÂêåÊ≠•Âçï‰∏™ËÆ¢ÂçïÂà∞ ERP
   */
  @Post('orders/:orderId/sync')
  async syncOrder(@Param('orderId') orderId: string) {
    return this.erpOrderSyncService.syncOrderToErp(orderId);
  }

  /**
   * ÈáçËØïÂêåÊ≠•Â§±Ë¥•ÁöÑËÆ¢Âçï
   */
  @Post('orders/:orderId/retry')
  async retrySyncOrder(@Param('orderId') orderId: string) {
    return this.erpOrderSyncService.syncOrderToErp(orderId);
  }

  /**
   * ÊâπÈáèÂêåÊ≠•ËÆ¢ÂçïÂà∞ ERP
   */
  @Post('orders/batch-sync')
  async batchSyncOrders(@Body() dto: BatchSyncDto) {
    return this.erpOrderSyncService.syncOrdersToErp(dto.orderIds);
  }

  /**
   * Ëé∑ÂèñÂêåÊ≠•Â§±Ë¥•ÁöÑËÆ¢ÂçïÂàóË°®
   */
  @Get('orders/failed')
  async getFailedOrders() {
    return this.erpOrderSyncService.getFailedSyncOrders();
  }

  /**
   * Ëé∑ÂèñÂæÖÂêåÊ≠•ÁöÑËÆ¢ÂçïÂàóË°®
   */
  @Get('orders/pending')
  async getPendingOrders() {
    return this.erpOrderSyncService.getPendingSyncOrders();
  }

  // ============ ÂÆ¢Êà∑Êò†Â∞ÑÁÆ°ÁêÜÊé•Âè£ ============

  /**
   * Ëé∑ÂèñÊâÄÊúâÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Get('mappings/customers')
  async getCustomerMappings() {
    return this.erpOrderSyncService.getAllCustomerMappings();
  }

  /**
   * ÂàõÂª∫ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Post('mappings/customers')
  async createCustomerMapping(@Body() dto: CreateMappingDto) {
    return this.erpOrderSyncService.createCustomerMapping(
      dto.websiteId,
      dto.erpNo,
    );
  }

  /**
   * Êõ¥Êñ∞ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Put('mappings/customers/:id')
  async updateCustomerMapping(
    @Param('id') id: string,
    @Body() dto: UpdateMappingDto,
  ) {
    return this.erpOrderSyncService.updateCustomerMapping(id, dto.erpNo);
  }

  /**
   * Âà†Èô§ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Delete('mappings/customers/:id')
  async deleteCustomerMapping(@Param('id') id: string) {
    return this.erpOrderSyncService.deleteCustomerMapping(id);
  }

  // ============ ‰∏öÂä°ÂëòÊò†Â∞ÑÁÆ°ÁêÜÊé•Âè£ ============

  /**
   * Ëé∑ÂèñÊâÄÊúâ‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Get('mappings/salespersons')
  async getSalespersonMappings() {
    return this.erpOrderSyncService.getAllSalespersonMappings();
  }

  /**
   * ÂàõÂª∫‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Post('mappings/salespersons')
  async createSalespersonMapping(@Body() dto: CreateMappingDto) {
    return this.erpOrderSyncService.createSalespersonMapping(
      dto.websiteId,
      dto.erpNo,
    );
  }

  /**
   * Êõ¥Êñ∞‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Put('mappings/salespersons/:id')
  async updateSalespersonMapping(
    @Param('id') id: string,
    @Body() dto: UpdateMappingDto,
  ) {
    return this.erpOrderSyncService.updateSalespersonMapping(id, dto.erpNo);
  }

  /**
   * Âà†Èô§‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Delete('mappings/salespersons/:id')
  async deleteSalespersonMapping(@Param('id') id: string) {
    return this.erpOrderSyncService.deleteSalespersonMapping(id);
  }

  // ============ ‰∫ßÂìÅÂêåÊ≠•Êé•Âè£ ============

  /**
   * ÊâãÂä®Ëß¶Âèë‰∫ßÂìÅÂêåÊ≠•
   * POST /erp/products/sync
   * Body: { incremental?: boolean, days?: number }
   */
  @Post('products/sync')
  async syncProducts(@Body() dto: ProductSyncDto) {
    const incremental = dto.incremental !== false; // ÈªòËÆ§Â¢ûÈáèÂêåÊ≠•
    const days = dto.days || 1;
    return this.erpProductSyncService.syncAndRecord(incremental, days);
  }

  /**
   * ÂÖ®ÈáèÂêåÊ≠•‰∫ßÂìÅ
   * POST /erp/products/sync-full
   */
  @Post('products/sync-full')
  async syncProductsFull() {
    return this.erpProductSyncService.syncAndRecord(false);
  }

  /**
   * Ëé∑Âèñ‰∏äÊ¨°ÂêåÊ≠•Êó∂Èó¥ÂíåÂü∫ÂáÜÊó∂Èó¥
   * GET /erp/products/last-sync
   */
  @Get('products/last-sync')
  async getLastSyncTime() {
    const lastSync = await this.erpProductSyncService.getLastSyncTime();
    const baseline = await this.erpProductSyncService.getSyncBaselineTime();

    return {
      lastSyncTime: lastSync?.toISOString() || null,
      lastSyncTimeFormatted: lastSync
        ? lastSync.toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' })
        : '‰ªéÊú™ÂêåÊ≠•',
      baselineTime: baseline.toISOString(),
      baselineTimeFormatted: baseline.toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' }),
    };
  }
}
EOF

mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- ERP ÂÆ¢Êà∑Êò†Â∞ÑË°®
CREATE TABLE IF NOT EXISTS `erp_customer_mapping` (
  `id` varchar(191) NOT NULL,
  `website_id` varchar(191) NOT NULL,
  `erp_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_customer_mapping_website_id_key` (`website_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ‰∏öÂä°ÂëòÊò†Â∞ÑË°®
CREATE TABLE IF NOT EXISTS `erp_salesperson_mapping` (
  `id` varchar(191) NOT NULL,
  `website_id` varchar(191) NOT NULL,
  `erp_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_salesperson_mapping_website_id_key` (`website_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ÂêåÊ≠•Êó•ÂøóË°®
CREATE TABLE IF NOT EXISTS `erp_sync_logs` (
  `id` varchar(191) NOT NULL,
  `order_id` varchar(191) NOT NULL,
  `status` varchar(191) NOT NULL,
  `message` text,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  PRIMARY KEY (`id`),
  KEY `erp_sync_logs_order_id_idx` (`order_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF


mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- Âà†Èô§ÊóßË°®ÈáçÂª∫
DROP TABLE IF EXISTS `erp_customer_mapping`;
DROP TABLE IF EXISTS `erp_salesperson_mapping`;

-- ERP ÂÆ¢Êà∑Êò†Â∞ÑË°®ÔºàÊ≠£Á°ÆÁªìÊûÑÔºâ
CREATE TABLE `erp_customer_mapping` (
  `id` varchar(191) NOT NULL,
  `website_customer_id` varchar(191) NOT NULL,
  `erp_customer_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_customer_mapping_website_customer_id_key` (`website_customer_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ‰∏öÂä°ÂëòÊò†Â∞ÑË°®ÔºàÊ≠£Á°ÆÁªìÊûÑÔºâ
CREATE TABLE `erp_salesperson_mapping` (
  `id` varchar(191) NOT NULL,
  `website_salesperson_id` varchar(191) NOT NULL,
  `erp_salesperson_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_salesperson_mapping_website_salesperson_id_key` (`website_salesperson_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO

-- Êü•Áúã‰∏öÂä°ÂëòË°®ÁªìÊûÑ
EXEC sp_help 'SALM';
GO

-- Êü•ÁúãÂá†Êù°‰∏öÂä°ÂëòÊï∞ÊçÆ
SELECT TOP 5 * FROM SALM;
GO

EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- ÊúÄËøë3Êù°ÂÆ¢Êà∑
SELECT TOP 3 CUS_NO, NAME, TEL1, SAL FROM CUST ORDER BY CREATE_DD DESC;
GO
-- ÊúÄËøë3Êù°‰∏öÂä°Âëò
SELECT TOP 200 SAL_NO, NAME FROM SALM ORDER BY SAL_NO DESC;
GO
-- ÊúÄËøë3Êù°ËÆ¢Âçï
SELECT TOP 3 OS_NO, OS_DD, CUS_NO, SAL_NO, AMTN_INT FROM MF_POS WHERE OS_ID='SO' ORDER BY RECORD_DD DESC;
GO
EOF

MP0034  ÁéãËïæ
MP0033  ÈáëÈú≤Êôì
MP0032  ÊñπÊôìÁèç
MP0031  ÈÉùÊñáÈõ®
MP0030  Âë®Èú≤
MP0021  ‰ªìÁÆ°‰∫å
MP0020  ‰ªìÁÆ°‰∏Ä
MP0019  ËÉ°Â∫∑Á´ã
MP0018  ÈôàÈ£òÈ£ò
MP0017  ÂåÖÂâëÊä•
MP0016  Âº†ÊùÉÁáï
MP0015  ÈôàÂ§ßÂºÄ
MP0014  ËÆ∏ÊâøÂª∫
MP0013  ÈíàËΩ¶ËΩ¶Èó¥
MP0012  Ê≥®Â°ëËΩ¶Èó¥
MP0011  Â∞πÂÄ©
MP0010  Âº†ÂâëËä≥
MP0009  Âº†Â∏Ö
MP0008  ‰ΩïÊôìÈ∏Ø
MP0007  Ê•öÁêÜÂáØ
MP0006  Áî≥Â±†Êñå
MP0005  ÊùéÂ∞èÁáï
MP0004  Èôà‰∏π
MP0003  Ê±™Â¢ûÁèç
MP0002  Âê¥ÂÜ¨Ëêç


npx prisma db execute --schema=./prisma/schema.prisma --stdin <<< 'DELETE FROM erp_customer_mapping; DELETE FROM erp_salesperson_mapping;'

npx prisma db execute --schema=./prisma/schema.prisma --stdin <<< 'SELECT * FROM erp_customer_mapping; SELECT * FROM erp_salesperson_mapping;'


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01
GO
DELETE FROM CUST WHERE CUS_NO LIKE 'TEST_%'
DELETE FROM SALM WHERE SAL_NO LIKE 'TEST_%'
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- 1. MF_POS ËÆ¢Âçï‰∏ªË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM MF_POS WHERE OS_NO='SO202511051';
GO
-- 2. TF_POS ËÆ¢ÂçïÊòéÁªÜ‰∏ªË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM TF_POS WHERE OS_NO='SO202511051';
GO
-- 3. TF_POS_Z ËÆ¢ÂçïÊòéÁªÜÊâ©Â±ïË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM TF_POS_Z WHERE OS_NO='SO202511051';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO

-- 1. ÂàõÂª∫ÁâπÂæÅÁªÑÔºàMARK_NOÊ†ºÂºèÊåâÁÖßÁé∞ÊúâÁöÑ 2-xxx Ê†ºÂºèÔºâ
INSERT INTO MARKS (MARK_NO, MARK_NAME, REM)
VALUES ('2-100', 'TB100', 'ÊµãËØïÊ∏ÖÊ¥ÅÂ•óË£ÖÁâπÂæÅÁªÑ');
GO

-- 2. ÂàõÂª∫ÈôÑÂä†Â±ûÊÄßÔºà3‰∏™È¢úËâ≤ÁªÑÂêàÈÄâÈ°πÔºâ
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '486CÊöóÁ∫¢+7717CÂ≠îÈõÄËìù+7548CÂßúÈªÑ+10CÂÜ∑ÁÅ∞', 'È¢úËâ≤ÁªÑÂêà1');
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '225CÂ∏∏ËßÑÁé´Á∫¢+375CÂ∏∏ËßÑÁªø+298CÂ∏∏ËßÑËìù+424CÁÅ∞', 'È¢úËâ≤ÁªÑÂêà2');
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '6CÂÜ∑ÁÅ∞+305CËìù+13-5304TPGÂç°ÂÖ∂+15-2216TCXÁ≤âËâ≤', 'È¢úËâ≤ÁªÑÂêà3');
GO

-- 3. ÂàõÂª∫3‰∏™SKU‰∫ßÂìÅ
-- ‰∏â‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.1111', 'TB100-Ê∏ÖÊ¥Å‰∏â‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());

-- Âõõ‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.2222', 'TB100-Ê∏ÖÊ¥ÅÂõõ‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:ÂèØÊãÜÂç∏Ê∞¥Ê°∂ÈÖç‰ª∂
D:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());

-- ÂÖ≠‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.3333', 'TB100-Ê∏ÖÊ¥ÅÂÖ≠‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:ÂèØÊãÜÂç∏Ê∞¥Ê°∂ÈÖç‰ª∂
D:360¬∞ÊóãËΩ¨ÊãñÊääÂ§¥
E:Â§áÁî®Ë∂ÖÁªÜÁ∫§Áª¥Â∏ÉÂ§¥
F:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());
GO

-- 4. È™åËØÅÊèíÂÖ•ÁªìÊûú
SELECT * FROM MARKS WHERE MARK_NO = '2-100';
SELECT * FROM PRD_MARKS WHERE MARK_NO = '2-100';
SELECT PRD_NO, NAME, MARK_NO FROM PRDT WHERE MARK_NO = '2-100';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- Êü•Áúã‰∫ßÂìÅÊï∞ÊçÆÊòØÂê¶‰π±Á†Å
SELECT PRD_NO, NAME, SPC FROM PRDT WHERE PRD_NO IN ('C04.01.1111', 'C04.01.2222', 'C04.01.3333');
GO
-- Êü•ÁúãÁâπÂæÅÁªÑ
SELECT * FROM MARKS WHERE MARK_NO = '2-100';
GO
-- Êü•ÁúãÈôÑÂä†Â±ûÊÄß
SELECT * FROM PRD_MARKS WHERE MARK_NO = '2-100';
GO
EOF


mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- ÂÖàÊü•ÁúãË¶ÅÂà†Èô§ÁöÑÊï∞ÊçÆ
SELECT id, product_code, product_name FROM product_skus WHERE product_code IN ('C04.01.1111', 'C04.01.2222',
'C04.01.3333');

-- Âà†Èô§ SKU
DELETE FROM product_skus WHERE product_code IN ('C04.01.1111', 'C04.01.2222', 'C04.01.3333');

-- Âà†Èô§‰∫ßÂìÅÁªÑ
DELETE FROM product_groups WHERE prefix = 'TB100';

-- Âà†Èô§Ëá™Âä®ÂàõÂª∫ÁöÑÂàÜÁ±ª
DELETE FROM categories WHERE code = 'TB' AND is_auto_created = 1 AND id NOT IN (SELECT category_id FROM
product_groups WHERE category_id IS NOT NULL);
EOF

mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- Êü•ÁúãË°®ÁªìÊûÑ
DESCRIBE product_skus;

-- Êü•Áúã TB100 Áõ∏ÂÖ≥Êï∞ÊçÆ
SELECT * FROM product_skus WHERE product_code LIKE 'C04.01.%' LIMIT 10;
EOF


mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- Âà†Èô§ TB100 ÁöÑ SKU
DELETE FROM product_skus WHERE product_code IN ('C04.01.1111', 'C04.01.2222', 'C04.01.3333');

-- Âà†Èô§ TB100 ‰∫ßÂìÅÁªÑ
DELETE FROM product_groups WHERE prefix = 'TB100';
EOF

grep -n "COLLATE\|status.*ACTIVE" ~/internal_web/mall_mingping_internal/code/backend-api/src/erp/erp-product-sync.service.ts


mysql -u lemopx -p'1q!' internal_sales -e "SELECT product_code, product_name, status FROM product_skus WHERE product_code LIKE 'C04.01.1%' OR product_code LIKE 'C04.01.2%' OR product_code LIKE 'C04.01.3%';"

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'TF_POS' AND DATA_TYPE IN ('varchar', 'nvarchar', 'char')
ORDER BY ORDINAL_POSITION;
GO
EOF

mysql -u lemopx -p'1q!' internal_sales -e "SELECT product_spec, LENGTH(product_spec), supplier_note, LENGTH(supplier_note) FROM order_items ORDER BY created_at DESC LIMIT 5;"

mysql -u lemopx -p'1q!' internal_sales -e "SELECT additional_attributes, LENGTH(additional_attributes) FROM order_items ORDER BY created_at DESC LIMIT 5;"


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT COLUMN_NAME, DATA_TYPE, CHARACTER_MAXIMUM_LENGTH
FROM INFORMATION_SCHEMA.COLUMNS
WHERE TABLE_NAME = 'TF_POS' AND COLUMN_NAME IN ('PRD_NAME', 'PRD_MARK', 'SPC', 'ATTR')
ORDER BY COLUMN_NAME;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 20 OS_ID, OS_NO, OS_DD, CUS_NO, SAL_NO
FROM MF_POS
ORDER BY RECORD_DD DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT * FROM MF_POS WHERE OS_NO = 'SO202511053';
GO
SELECT * FROM TF_POS WHERE OS_NO = 'SO202511053';
GO
SELECT * FROM TF_POS_Z WHERE OS_NO = 'SO202511053';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT * FROM MF_POS WHERE OS_NO = 'SO202511051';
GO
SELECT * FROM TF_POS WHERE OS_NO = 'SO202511051';
GO
SELECT * FROM TF_POS_Z WHERE OS_NO = 'SO202511051';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT * FROM MF_POS WHERE OS_NO = 'SO202511053';
GO
SELECT * FROM TF_POS WHERE OS_NO = 'SO202511053';
GO
SELECT * FROM TF_POS_Z WHERE OS_NO = 'SO202511053';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT OS_NO, CLS_ID, CHK_MAN, CHK_DD, VALID_ID, PRE_ID
FROM MF_POS
WHERE OS_ID = 'SO'
ORDER BY RECORD_DD DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 10 OS_NO, CLS_ID, CHK_MAN, CHK_DD, VALID_ID, PRE_ID
FROM MF_POS
WHERE OS_ID = 'SO'
ORDER BY RECORD_DD DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 100 OS_NO, OS_DD, RECORD_DD
FROM MF_POS
WHERE OS_ID = 'SO'
ORDER BY RECORD_DD DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- Êü•Áúã‰∏ªË°® MF_POS ‰∏≠ÊúÄËøëÁöÑËÆ¢Âçï
SELECT TOP 5 OS_NO, OS_DD, CUS_NO, SAL_NO, CLS_ID, AMTN_INT, REM
FROM MF_POS
WHERE OS_ID = 'SO'
ORDER BY OS_DD DESC;
GO
-- Êü•ÁúãÊòéÁªÜË°® TF_POS ‰∏≠Ëøô‰∫õËÆ¢ÂçïÁöÑÂÖ≥ÈîÆÂ≠óÊÆµ
SELECT OS_NO, ITM, PRD_NO, PRD_NAME, PRD_MARK, ATTR, SPC, QTY, UP, AMT, AMTN, TAX, TAX_RTO
FROM TF_POS
WHERE OS_ID = 'SO' AND OS_NO IN (SELECT TOP 5 OS_NO FROM MF_POS WHERE OS_ID = 'SO' ORDER BY OS_DD DESC)
ORDER BY OS_NO DESC, ITM;
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 10 * FROM WF_FLOW_INST ORDER BY 1 DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- Êü•Áúã‰πãÂâçËÉΩÊ≠£Â∏∏ÊòæÁ§∫ÁöÑËÆ¢Âçï
SELECT OS_NO, ITM, PRD_NO, PRD_NAME, PRD_MARK, ATTR, SPC, QTY, UP, AMT, AMTN, TAX, TAX_RTO
FROM TF_POS
WHERE OS_ID = 'SO' AND OS_NO IN ('SO202511005', 'SO202511006', 'SO202511007', 'SO202511008', 'SO202511009',
'SO202511010')
ORDER BY OS_NO, ITM;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- Êü•ÁúãSO202511051Ôºà‰Ω†ËØ¥ËÉΩÊòæÁ§∫ÁöÑÈÇ£‰∏™Ôºâ
SELECT OS_NO, ITM, PRD_NO, PRD_NAME, PRD_MARK, ATTR, SPC, QTY, UP, AMT, AMTN, TAX, TAX_RTO
FROM TF_POS
WHERE OS_NO = 'SO202511051';
GO
-- Êü•ÁúãSO202511056Ôºà‰∏çËÉΩÊòæÁ§∫ÁöÑÔºâ
SELECT OS_NO, ITM, PRD_NO, PRD_NAME, PRD_MARK, ATTR, SPC, QTY, UP, AMT, AMTN, TAX, TAX_RTO
FROM TF_POS
WHERE OS_NO = 'SO202511056';
GO
EOF

  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT * FROM WF_TEMPLATE WHERE TEMP_ID LIKE '%SO%' OR BIL_ID = 'SO';
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
DELETE FROM TF_POS_Z WHERE OS_NO = 'SO202511053';
DELETE FROM TF_POS WHERE OS_NO = 'SO202511053';
DELETE FROM MF_POS WHERE OS_NO = 'SO202511053';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
DELETE FROM TF_POS_Z WHERE OS_NO = 'SO202511051';
DELETE FROM TF_POS WHERE OS_NO = 'SO202511051';
DELETE FROM MF_POS WHERE OS_NO = 'SO202511051';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT OS_NO, SUBSTRING(OS_NO, 9, 10) as seq_str, CAST(SUBSTRING(OS_NO, 9, 10) AS INT) as seq_num
FROM MF_POS
WHERE OS_ID = 'SO' AND OS_NO LIKE 'SO202511%'
ORDER BY seq_num DESC;
GO
EOF

INST_ID     TEMP_ID BIL_NO  BIL_ID  BIL_DD  USR     DEP     REM     CUR_SH_USR      SH_STATE        CUR_NODE        TASK_STATE      BIL_ITM PRE_INFO        ISNOROUTING     INST_DD
36976   10019   SO202511050     SO      Nov 27 2025 12:00AM     MP0008  D1000   ÂÆ¢Êà∑ÂêçÁß∞:ÂπøÂ∑û‰∏≠ËΩªÂÆèÁ≠ñ;Â∏ÅÂà´:;ÂçïÊçÆÁ±ªÂà´Ôºö;ËÆ¢Ë¥≠1‰∏™Ë¥ßÂìÅ;Êï∞ÈáèÂêàËÆ°:4896;ÈáëÈ¢ùÂêàËÆ°:5385.6;       MP0001  4       10089   0       0       NULL    NULL    Nov 27 2025 08:52AM
36973   10019   SO202511049     SO      Nov 27 2025 12:00AM     MP0011  D5000   ÂÆ¢Êà∑ÂêçÁß∞:Âè∞Â∑ûÈªÑÂ≤©‰∫ö‰∫®;Â∏ÅÂà´:;ÂçïÊçÆÁ±ªÂà´Ôºö;ËÆ¢Ë¥≠1‰∏™Ë¥ßÂìÅ;Êï∞ÈáèÂêàËÆ°:3000;ÈáëÈ¢ùÂêàËÆ°:12300;        MP0001  4       10089   0       0       NULL    NULL    Nov 27 2025 08:34AM
36943   10019   SO202511048     SO      Nov 26 2025 12:00AM     MP0011  D1000   ÂÆ¢Êà∑ÂêçÁß∞:Êñ∞ÁñÜÈáëÂ∫úÂïÜË¥∏ÊúâÈôêË¥£‰ªªÂÖ¨Âè∏;Â∏ÅÂà´:;ÂçïÊçÆÁ±ªÂà´Ôºö;ËÆ¢Ë¥≠1‰∏™Ë¥ßÂìÅ;Êï∞ÈáèÂêàËÆ°:3000;ÈáëÈ¢ùÂêàËÆ°:9990;     MP0001  4       10089   0       0       NULL    NULL    Nov 26 2025 02:27PM
36931   10019   SO202511047     SO      Nov 26 2025 12:00AM     MP0011  D5000   ÂÆ¢Êà∑ÂêçÁß∞:ËΩ©Êµ©;Â∏ÅÂà´:;ÂçïÊçÆÁ±ªÂà´Ôºö;ËÆ¢Ë¥≠1‰∏™Ë¥ßÂìÅ;Êï∞ÈáèÂêàËÆ°:1600;ÈáëÈ¢ùÂêàËÆ°:5600; MP0001  4       10089   0       0       NULL    NULL    Nov 26 2025 10:16AM
36913   10019   SO202511046     SO      Nov 26 2025 12:00AM     MP0031  0000    ÂÆ¢Êà∑ÂêçÁß∞:Ê∏©Â∑ûÂæ∑ËÅîËøõÂá∫Âè£ÊúâÈôêÂÖ¨Âè∏;Â∏ÅÂà´:;ÂçïÊçÆÁ±ªÂà´Ôºö;ËÆ¢Ë¥≠1‰∏™Ë¥ßÂìÅ;Êï∞ÈáèÂêàËÆ°:500;ÈáëÈ¢ùÂêàËÆ°:7200;        MP0001  4       10089   0       0       NULL    NULL    Nov 26 2025 08:58AM
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT CUS_NO, NAME, BOSS, TEL, ADD1, EMAIL FROM CUST WHERE CUS_NO = 'C0178';
GO
SELECT SAL_NO, NAME FROM SALM WHERE SAL_NO = 'MP0035';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 10 INST_ID, BIL_NO, USR, DEP, CUR_SH_USR, SH_STATE, CUR_NODE, INST_DD
FROM WF_FLOW_INST
WHERE BIL_ID = 'SO'
ORDER BY INST_ID DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 5 INST_ID, BIL_NO, BIL_ID, USR, DEP, CUR_SH_USR, SH_STATE, CUR_NODE
FROM WF_FLOW_INST
WHERE SH_STATE = 0
ORDER BY INST_ID DESC;
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT DISTINCT SH_STATE, COUNT(*) as cnt FROM WF_FLOW_INST WHERE BIL_ID = 'SO' GROUP BY SH_STATE;
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT SH_STATE, COUNT(*) as cnt FROM WF_FLOW_INST GROUP BY SH_STATE ORDER BY SH_STATE;
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT DISTINCT DEP, COUNT(*) as cnt FROM WF_FLOW_INST WHERE BIL_ID = 'SO' GROUP BY DEP ORDER BY cnt DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT SAL_NO, NAME, DEP FROM SALM WHERE SAL_NO = 'MP0035';
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT COLUMN_NAME FROM INFORMATION_SCHEMA.COLUMNS WHERE TABLE_NAME = 'CUST';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 5 * FROM WF_FLOW_INST WHERE BIL_ID = 'SO' ORDER BY INST_ID DESC;
GO
EOF
  
tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT * FROM WF_TEMPLATE WHERE TEMP_ID LIKE '%SO%' OR BIL_ID = 'SO';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT CUS_NO, NAME, CNT_MAN1, TEL1, ADR1, E_MAIL, COUNTRY FROM CUST WHERE CUS_NO = 'C0178';
GO
EOF


> 1> 2> 1> 2> OS_ID       OS_NO   BAT_NO  OS_DD   QT_NO   VOH_ID  VOH_NO  TRAD_MTH        PAY_MTH PAY_DAYS        CHK_DAYS        PAY_REM SEND_MTH        SEND_WH EST_DD  CUS_NO  SAL_NO  USE_DEP CUR_ID
EXC_RTO AMTN_INT        AMT_INT DIS_CNT CLS_ID  BACK_ID HIS_PRICE      ADR     REM     PO_DEP  PO_SO_NO        SO_BY_MM        SO_OT_DD        SO_BY_DD        SO_LNG_CAS      SO_END_DD       SO_LST_DD
  INV_DIS_ID      INV_NO  TAX_ID  RP_NO   OLD_INV_NO      AMTN_NET        TAX     PAY_DD  CHK_DD  INT_DAYS        USR   CHK_MAN  CONTRACT        PRT_SW  CPY_SW  BIL_NO  LC_NO   AMTN_DIS        CLS_MP_ID
    CLS_REM BIL_ID  RK_CLS_ID       PRE_ID  IS_POS  POS_NO  CLS_DATE        PCL_ID  CUS_OS_NO       BZ_NO   HS_ID   RK_ID   BIL_TYPE        LOCK_MAN        FIN_DD  EFF_DD  CLEAR_ID       CO_NO   RECORD_DD
      DEF_NO  YX_NO   CHK_MAN1        VALID_ID        MAN_CLS MAN_RK_CLS      IS_TRANS        FORCAST ZHANG_ID        OBJ_NO  OBJ_CLASS       SHOP_NO TRADE_ID        EMAIL_ID        TB_NO   AMTN_FY PCLS
 AFFECT_SQ       COPY_NO BUYERNOSALERNO INVOICETYPE     INVOICEKIND
SO      SO202511052     NULL    Nov 27 2025 08:00AM     NULL    NULL    NULL    NULL    1       NULL    NULL    NULL    1       W1000   Nov 30 2025 08:00AM     C0178   MP0035  NULL    NULL    NULL
888.00000000    NULL    NULL    F       NULL    NULL    NULL  {}       NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL
  NULL    MP0035  NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL  NULL     NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL
    NULL    NULL    Nov 28 2025 01:21AM     NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL  NULL     NULL    NULL
NULL    NULL    NULL
(1 row affected)
1> 2> OS_ID     OS_NO   ITM     QT_NO   PRD_NO  PRD_NAME        PRD_MARK        WH      UNIT    OS_DD   QTY     UP      DIS_CNT AMT     AMTN    TAX     QTY1    QTY_PS  QTY1_PS EST_DD  PAK_UNIT
PAK_EXC PAK_NW  PAK_WEIGHT_UNIT PAK_GW  PAK_MEAST       PAK_MEAST_UNIT VALID_DD        REM     AMTN_COM        CLS_MP_ID       CST_STD UP_QTY1 EST_ITM SEND_WH UT      CODE_NO ATTR    QTY_RK  BAT_NO
PRE_EST_DD      QTY_PO  QTY_PRE PRE_ITM ID_NO   QTY_YS  FREE_ID BIL_ID  BZ_KND  PRICE_ID        OTH_ITM TAX_RTO CHK_TAX QTY_JHQTY_FH   JH_NO   PRD_LOC SEQ_ITM MRP_NO_SO       AMT_FP  QTY_FP  QTY_BAD UP_END
  QTY_WAY QTY_NOSH        QTY_NOSH_PRE    QTY_NOSH_PS     QTY_NOSH_WAY    QTY_NOSH_RK     QTY_NOSH_FH     CO_NO   SO_NO   SEFF_DATE       TD_NUM  QTY_FP_NOSH     AMT_FP_NOSH     UP_DJ FORMULA_CSV      SPC
    QTY_TH  QTY_NOSH_TH     FREEINDEX       ORDER_ID        UPR     TB_NO   BCLS_ID OBJ_NO  BCLS_DATE       TB_SUB_NO       COM_SJNO        OBJ_CLASS       PRICE_ITEM      PRD_NO_SUP      INVOICESPC
INVOICENAME     PRD_NAME_SUP
SO      SO202511052     1       NULL    C04.01.3333     TB100-Ê∏ÖÊ¥ÅÂÖ≠‰ª∂Â•ó        6CÂÜ∑ÁÅ∞+305CËìù+13-5304TPGÂç°ÂÖ∂+15-2216TCXÁ≤âËâ≤     W1000   1       Nov 27 2025 08:00AM     1.00000000      888.00000000    NULL
   985.68000000    888.00000000    97.68000000     NULL  NULL     NULL    Nov 30 2025 08:00AM     11      11.00000000     11.00000000     11      11.00000000     0.01687200      m3      NULL    Âï•Êó∂Èó¥
NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    6CÂÜ∑ÁÅ∞+305CËìù+13-5304TPGÂç°ÂÖ∂+1  NULL    NULL    NULL  NULL     NULL    NULL    NULL    NULL    NULL    NULL    11      NULL    NULL
11.00000000     NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL  NULL     NULL    NULL
  NULL    NULL    A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:ÂèØÊãÜÂç∏Ê∞¥Ê°∂ÈÖç‰ª∂
D:360¬∞ÊóãËΩ¨ÊãñÊääÂ§¥
E:Â§áÁî®Ë∂ÖÁªÜÁ∫§Áª¥Â∏ÉÂ§¥
F:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g   NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL    NULL
(1 row affected)
1> 2> OS_NO     OS_ID   ITM     ZS      ZC      ZG      ZM1     BZ1     ZP      JHKH    PQTY2   SXBBM   DKBM    WXBM    XG      PQTY3   PQTY1   BZFS    CSHH    CSBZ    TJ
SO202511052     SO      1       NULL    NULL    NULL    NULL    NULL    NULL    NULL    11      97349856        345346546       1145465456      74*19*12        NULL    11      53465   NULL    NULL


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT OS_NO, QTY, UP, AMT, AMTN, TAX, TAX_RTO
FROM TF_POS
WHERE OS_NO IN ('SO202511050', 'SO202511051')
ORDER BY OS_NO;
GO
EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT DISTINCT TAX_RTO, COUNT(*) as cnt
FROM TF_POS
GROUP BY TAX_RTO
ORDER BY cnt DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 50 OS_NO, TAX_RTO
FROM TF_POS
WHERE OS_NO LIKE 'SO%'
ORDER BY OS_NO DESC;
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT TOP 10 OS_NO, CLS_ID, SEND_MTH, PAY_MTH, SEND_WH
FROM MF_POS
WHERE OS_ID = 'SO'
ORDER BY RECORD_DD DESC;
GO
EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
SELECT DISTINCT SEND_WH FROM MF_POS WHERE OS_ID = 'SO';
GO
EOF