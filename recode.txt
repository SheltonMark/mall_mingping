cd ~/internal_web/mall_mingping_internal/code/backend-api

cat > .env << 'EOF'
DATABASE_URL="mysql://lemopx:1q!@localhost:3306/internal_sales"
JWT_SECRET="HF3suIJ4mHk9OQBwDRAqYqUC9Eaq8HyCabPaXoAx7yI="
PORT=3001
HOST=0.0.0.0
CORS_ORIGIN=*

ERP_SYNC_ENABLED=true
ERP_DB_HOST=192.168.3.254
ERP_DB_PORT=1433
ERP_DB_USER=sa
ERP_DB_PASSWORD=1q!
ERP_DB_NAME=DB_MP01
EOF

cat > .env << 'EOF'
NEXT_PUBLIC_API_URL=http://192.168.13.17:3001/api
EOF


cat > src/main.ts << 'EOF'
import { NestFactory } from '@nestjs/core';
import { AppModule } from './app.module';
import { ValidationPipe } from '@nestjs/common';
import { NestExpressApplication } from '@nestjs/platform-express';
import { join } from 'path';
import { PrismaService } from './prisma.service';

async function bootstrap() {
  const app = await NestFactory.create<NestExpressApplication>(AppModule);

  // Enable CORS
  app.enableCors({
    origin: process.env.CORS_ORIGIN === '*' ? true : (process.env.CORS_ORIGIN ||
'http://localhost:3000').split(','),
    credentials: true,
  });

  // Global validation pipe
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      transform: true,
      forbidNonWhitelisted: true,
      transformOptions: {
        enableImplicitConversion: true,
      },
    }),
  );

  // Serve static files from uploads directory
  app.useStaticAssets(join(__dirname, '..', 'uploads'), {
    prefix: '/uploads/',
  });

  // Set global prefix
  app.setGlobalPrefix('api');

  // Enable shutdown hooks for Prisma
  const prismaService = app.get(PrismaService);
  await prismaService.enableShutdownHooks(app);

  const port = process.env.PORT || 3001;
  const host = process.env.HOST || '0.0.0.0';
  await app.listen(port, host);

  console.log(`üöÄ Server is running on: http://${host}:${port}/api`);
  console.log(`üìÅ Static files served from: /uploads/`);
}
bootstrap();
EOF

netsh interface portproxy add v4tov4 listenport=3000 listenaddress=0.0.0.0 connectport=3000 connectaddress=172.31.15.84

netsh interface portproxy add v4tov4 listenport=3001 listenaddress=0.0.0.0 connectport=3001 connectaddress=172.31.15.84

  # Êü•ÁúãÊòØÂê¶ÊàêÂäü
  netsh interface portproxy show all

  # ÂÖÅËÆ∏Èò≤ÁÅ´Â¢ô
  netsh advfirewall firewall add rule name="WSL 3000" dir=in action=allow protocol=tcp localport=3000
  netsh advfirewall firewall add rule name="WSL 3001" dir=in action=allow protocol=tcp localport=3001
  
  
  
  
  
  
  
cat > /home/lemopx/internal_web/mall_mingping_internal/code/backend-api/src/main.ts << 'EOF'
import { NestFactory } from '@nestjs/core';
import { ValidationPipe } from '@nestjs/common';
import { NestExpressApplication } from '@nestjs/platform-express';
import { join } from 'path';
import { AppModule } from './app.module';
import { PrismaService } from './prisma.service';

async function bootstrap() {
  const app = await NestFactory.create<NestExpressApplication>(AppModule);

  // Enable CORS
  app.enableCors({
    origin: process.env.CORS_ORIGIN === '*' ? true : (process.env.CORS_ORIGIN ||
'http://localhost:3000').split(','),
    credentials: true,
  });

  // Global validation pipe
  app.useGlobalPipes(
    new ValidationPipe({
      whitelist: true,
      forbidNonWhitelisted: true,
      transform: true,
    }),
  );

  // Serve static files from public directory (for admin UI)
  app.useStaticAssets(join(process.cwd(), 'public'), {
    prefix: '/',
  });

  // Serve static files from uploads directory
  const uploadsDir = process.env.UPLOAD_DIR || './uploads';
  console.log('üìÅ Uploads directory:', join(process.cwd(), uploadsDir));
  app.useStaticAssets(join(process.cwd(), uploadsDir), {
    prefix: '/uploads/',
  });

  // Global prefix (must come after static assets)
  app.setGlobalPrefix('api');

  // Prisma shutdown hook
  const prismaService = app.get(PrismaService);
  await prismaService.enableShutdownHooks(app);

  const port = process.env.PORT || 3001;
  const host = process.env.HOST || '0.0.0.0';
  await app.listen(port, host);

  console.log(`üöÄ Server is running on: http://${host}:${port}/api`);
  console.log(`üìÅ Static files served from: /uploads/`);
}
bootstrap();
EOF


export https_proxy=http://127.0.0.1:33210 http_proxy=http://127.0.0.1:33210 all_proxy=socks5://127.0.0.1:33211


sed -i "s/} from '@nestjs\/common';/} from '@nestjs\/common';\nimport { IsString, IsOptional, IsBoolean, IsNumber, IsArray } from 'class-validator';/" erp.controller.ts



mysql -u lemopx -p'1q!' internal_sales << 'EOF'
CREATE TABLE IF NOT EXISTS `cart_items` (
  `id` varchar(191) NOT NULL,
  `salesperson_id` varchar(191) NOT NULL,
  `sku_id` varchar(191) NOT NULL,
  `product_code` varchar(191) NOT NULL,
  `product_name` varchar(191) NOT NULL,
  `color_scheme` json DEFAULT NULL,
  `quantity` int NOT NULL DEFAULT '1',
  `price` decimal(65,30) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `cart_items_salesperson_id_idx` (`salesperson_id`),
  CONSTRAINT `cart_items_salesperson_id_fkey` FOREIGN KEY (`salesperson_id`) REFERENCES `salespersons` (`id`) ON
DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF



  cd ~/internal_web/mall_mingping_internal/code/backend-api/src/erp

cat > erp.controller.ts << 'EOF'
import {
  Controller,
  Post,
  Get,
  Delete,
  Put,
  Param,
  Body,
  Query,
  UseGuards,
} from '@nestjs/common';
import { IsString, IsOptional, IsBoolean, IsNumber, IsArray } from 'class-validator';
import { ErpOrderSyncService } from './erp-order-sync.service';
import { ErpProductSyncService } from './erp-product-sync.service';
import { JwtAuthGuard } from '../common/guards/jwt-auth.guard';

// DTO ÂÆö‰πâ
class CreateMappingDto {
  @IsString()
  websiteId: string;

  @IsString()
  erpNo: string;
}

class UpdateMappingDto {
  @IsString()
  erpNo: string;
}

class BatchSyncDto {
  @IsArray()
  @IsString({ each: true })
  orderIds: string[];
}

class ProductSyncDto {
  @IsOptional()
  @IsBoolean()
  incremental?: boolean; // ÊòØÂê¶Â¢ûÈáèÂêåÊ≠•ÔºåÈªòËÆ§ true

  @IsOptional()
  @IsNumber()
  days?: number;         // Â¢ûÈáèÂêåÊ≠•Â§©Êï∞ÔºåÈªòËÆ§ 1
}

@Controller('erp')
@UseGuards(JwtAuthGuard)
export class ErpController {
  constructor(
    private readonly erpOrderSyncService: ErpOrderSyncService,
    private readonly erpProductSyncService: ErpProductSyncService,
  ) {}

  // ============ ËÆ¢ÂçïÂêåÊ≠•Êé•Âè£ ============

  /**
   * ÂêåÊ≠•Âçï‰∏™ËÆ¢ÂçïÂà∞ ERP
   */
  @Post('orders/:orderId/sync')
  async syncOrder(@Param('orderId') orderId: string) {
    return this.erpOrderSyncService.syncOrderToErp(orderId);
  }

  /**
   * ÈáçËØïÂêåÊ≠•Â§±Ë¥•ÁöÑËÆ¢Âçï
   */
  @Post('orders/:orderId/retry')
  async retrySyncOrder(@Param('orderId') orderId: string) {
    return this.erpOrderSyncService.syncOrderToErp(orderId);
  }

  /**
   * ÊâπÈáèÂêåÊ≠•ËÆ¢ÂçïÂà∞ ERP
   */
  @Post('orders/batch-sync')
  async batchSyncOrders(@Body() dto: BatchSyncDto) {
    return this.erpOrderSyncService.syncOrdersToErp(dto.orderIds);
  }

  /**
   * Ëé∑ÂèñÂêåÊ≠•Â§±Ë¥•ÁöÑËÆ¢ÂçïÂàóË°®
   */
  @Get('orders/failed')
  async getFailedOrders() {
    return this.erpOrderSyncService.getFailedSyncOrders();
  }

  /**
   * Ëé∑ÂèñÂæÖÂêåÊ≠•ÁöÑËÆ¢ÂçïÂàóË°®
   */
  @Get('orders/pending')
  async getPendingOrders() {
    return this.erpOrderSyncService.getPendingSyncOrders();
  }

  // ============ ÂÆ¢Êà∑Êò†Â∞ÑÁÆ°ÁêÜÊé•Âè£ ============

  /**
   * Ëé∑ÂèñÊâÄÊúâÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Get('mappings/customers')
  async getCustomerMappings() {
    return this.erpOrderSyncService.getAllCustomerMappings();
  }

  /**
   * ÂàõÂª∫ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Post('mappings/customers')
  async createCustomerMapping(@Body() dto: CreateMappingDto) {
    return this.erpOrderSyncService.createCustomerMapping(
      dto.websiteId,
      dto.erpNo,
    );
  }

  /**
   * Êõ¥Êñ∞ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Put('mappings/customers/:id')
  async updateCustomerMapping(
    @Param('id') id: string,
    @Body() dto: UpdateMappingDto,
  ) {
    return this.erpOrderSyncService.updateCustomerMapping(id, dto.erpNo);
  }

  /**
   * Âà†Èô§ÂÆ¢Êà∑Êò†Â∞Ñ
   */
  @Delete('mappings/customers/:id')
  async deleteCustomerMapping(@Param('id') id: string) {
    return this.erpOrderSyncService.deleteCustomerMapping(id);
  }

  // ============ ‰∏öÂä°ÂëòÊò†Â∞ÑÁÆ°ÁêÜÊé•Âè£ ============

  /**
   * Ëé∑ÂèñÊâÄÊúâ‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Get('mappings/salespersons')
  async getSalespersonMappings() {
    return this.erpOrderSyncService.getAllSalespersonMappings();
  }

  /**
   * ÂàõÂª∫‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Post('mappings/salespersons')
  async createSalespersonMapping(@Body() dto: CreateMappingDto) {
    return this.erpOrderSyncService.createSalespersonMapping(
      dto.websiteId,
      dto.erpNo,
    );
  }

  /**
   * Êõ¥Êñ∞‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Put('mappings/salespersons/:id')
  async updateSalespersonMapping(
    @Param('id') id: string,
    @Body() dto: UpdateMappingDto,
  ) {
    return this.erpOrderSyncService.updateSalespersonMapping(id, dto.erpNo);
  }

  /**
   * Âà†Èô§‰∏öÂä°ÂëòÊò†Â∞Ñ
   */
  @Delete('mappings/salespersons/:id')
  async deleteSalespersonMapping(@Param('id') id: string) {
    return this.erpOrderSyncService.deleteSalespersonMapping(id);
  }

  // ============ ‰∫ßÂìÅÂêåÊ≠•Êé•Âè£ ============

  /**
   * ÊâãÂä®Ëß¶Âèë‰∫ßÂìÅÂêåÊ≠•
   * POST /erp/products/sync
   * Body: { incremental?: boolean, days?: number }
   */
  @Post('products/sync')
  async syncProducts(@Body() dto: ProductSyncDto) {
    const incremental = dto.incremental !== false; // ÈªòËÆ§Â¢ûÈáèÂêåÊ≠•
    const days = dto.days || 1;
    return this.erpProductSyncService.syncAndRecord(incremental, days);
  }

  /**
   * ÂÖ®ÈáèÂêåÊ≠•‰∫ßÂìÅ
   * POST /erp/products/sync-full
   */
  @Post('products/sync-full')
  async syncProductsFull() {
    return this.erpProductSyncService.syncAndRecord(false);
  }

  /**
   * Ëé∑Âèñ‰∏äÊ¨°ÂêåÊ≠•Êó∂Èó¥ÂíåÂü∫ÂáÜÊó∂Èó¥
   * GET /erp/products/last-sync
   */
  @Get('products/last-sync')
  async getLastSyncTime() {
    const lastSync = await this.erpProductSyncService.getLastSyncTime();
    const baseline = await this.erpProductSyncService.getSyncBaselineTime();

    return {
      lastSyncTime: lastSync?.toISOString() || null,
      lastSyncTimeFormatted: lastSync
        ? lastSync.toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' })
        : '‰ªéÊú™ÂêåÊ≠•',
      baselineTime: baseline.toISOString(),
      baselineTimeFormatted: baseline.toLocaleString('zh-CN', { timeZone: 'Asia/Shanghai' }),
    };
  }
}
EOF

mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- ERP ÂÆ¢Êà∑Êò†Â∞ÑË°®
CREATE TABLE IF NOT EXISTS `erp_customer_mapping` (
  `id` varchar(191) NOT NULL,
  `website_id` varchar(191) NOT NULL,
  `erp_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_customer_mapping_website_id_key` (`website_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ‰∏öÂä°ÂëòÊò†Â∞ÑË°®
CREATE TABLE IF NOT EXISTS `erp_salesperson_mapping` (
  `id` varchar(191) NOT NULL,
  `website_id` varchar(191) NOT NULL,
  `erp_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_salesperson_mapping_website_id_key` (`website_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ÂêåÊ≠•Êó•ÂøóË°®
CREATE TABLE IF NOT EXISTS `erp_sync_logs` (
  `id` varchar(191) NOT NULL,
  `order_id` varchar(191) NOT NULL,
  `status` varchar(191) NOT NULL,
  `message` text,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  PRIMARY KEY (`id`),
  KEY `erp_sync_logs_order_id_idx` (`order_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF


mysql -u lemopx -p'1q!' internal_sales << 'EOF'
-- Âà†Èô§ÊóßË°®ÈáçÂª∫
DROP TABLE IF EXISTS `erp_customer_mapping`;
DROP TABLE IF EXISTS `erp_salesperson_mapping`;

-- ERP ÂÆ¢Êà∑Êò†Â∞ÑË°®ÔºàÊ≠£Á°ÆÁªìÊûÑÔºâ
CREATE TABLE `erp_customer_mapping` (
  `id` varchar(191) NOT NULL,
  `website_customer_id` varchar(191) NOT NULL,
  `erp_customer_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_customer_mapping_website_customer_id_key` (`website_customer_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ERP ‰∏öÂä°ÂëòÊò†Â∞ÑË°®ÔºàÊ≠£Á°ÆÁªìÊûÑÔºâ
CREATE TABLE `erp_salesperson_mapping` (
  `id` varchar(191) NOT NULL,
  `website_salesperson_id` varchar(191) NOT NULL,
  `erp_salesperson_no` varchar(191) NOT NULL,
  `created_at` datetime(3) NOT NULL DEFAULT CURRENT_TIMESTAMP(3),
  `updated_at` datetime(3) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `erp_salesperson_mapping_website_salesperson_id_key` (`website_salesperson_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO

-- Êü•Áúã‰∏öÂä°ÂëòË°®ÁªìÊûÑ
EXEC sp_help 'SALM';
GO

-- Êü•ÁúãÂá†Êù°‰∏öÂä°ÂëòÊï∞ÊçÆ
SELECT TOP 5 * FROM SALM;
GO

EOF


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- ÊúÄËøë3Êù°ÂÆ¢Êà∑
SELECT TOP 3 CUS_NO, NAME, TEL1, SAL FROM CUST ORDER BY CREATE_DD DESC;
GO
-- ÊúÄËøë3Êù°‰∏öÂä°Âëò
SELECT TOP 200 SAL_NO, NAME FROM SALM ORDER BY SAL_NO DESC;
GO
-- ÊúÄËøë3Êù°ËÆ¢Âçï
SELECT TOP 3 OS_NO, OS_DD, CUS_NO, SAL_NO, AMTN_INT FROM MF_POS WHERE OS_ID='SO' ORDER BY RECORD_DD DESC;
GO
EOF

MP0034  ÁéãËïæ
MP0033  ÈáëÈú≤Êôì
MP0032  ÊñπÊôìÁèç
MP0031  ÈÉùÊñáÈõ®
MP0030  Âë®Èú≤
MP0021  ‰ªìÁÆ°‰∫å
MP0020  ‰ªìÁÆ°‰∏Ä
MP0019  ËÉ°Â∫∑Á´ã
MP0018  ÈôàÈ£òÈ£ò
MP0017  ÂåÖÂâëÊä•
MP0016  Âº†ÊùÉÁáï
MP0015  ÈôàÂ§ßÂºÄ
MP0014  ËÆ∏ÊâøÂª∫
MP0013  ÈíàËΩ¶ËΩ¶Èó¥
MP0012  Ê≥®Â°ëËΩ¶Èó¥
MP0011  Â∞πÂÄ©
MP0010  Âº†ÂâëËä≥
MP0009  Âº†Â∏Ö
MP0008  ‰ΩïÊôìÈ∏Ø
MP0007  Ê•öÁêÜÂáØ
MP0006  Áî≥Â±†Êñå
MP0005  ÊùéÂ∞èÁáï
MP0004  Èôà‰∏π
MP0003  Ê±™Â¢ûÁèç
MP0002  Âê¥ÂÜ¨Ëêç


npx prisma db execute --schema=./prisma/schema.prisma --stdin <<< 'DELETE FROM erp_customer_mapping; DELETE FROM erp_salesperson_mapping;'

npx prisma db execute --schema=./prisma/schema.prisma --stdin <<< 'SELECT * FROM erp_customer_mapping; SELECT * FROM erp_salesperson_mapping;'


tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01
GO
DELETE FROM CUST WHERE CUS_NO LIKE 'TEST_%'
DELETE FROM SALM WHERE SAL_NO LIKE 'TEST_%'
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- 1. MF_POS ËÆ¢Âçï‰∏ªË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM MF_POS WHERE OS_NO='SO202511051';
GO
-- 2. TF_POS ËÆ¢ÂçïÊòéÁªÜ‰∏ªË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM TF_POS WHERE OS_NO='SO202511051';
GO
-- 3. TF_POS_Z ËÆ¢ÂçïÊòéÁªÜÊâ©Â±ïË°® (ÈùûÁ©∫Â≠óÊÆµ)
SELECT * FROM TF_POS_Z WHERE OS_NO='SO202511051';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO

-- 1. ÂàõÂª∫ÁâπÂæÅÁªÑÔºàMARK_NOÊ†ºÂºèÊåâÁÖßÁé∞ÊúâÁöÑ 2-xxx Ê†ºÂºèÔºâ
INSERT INTO MARKS (MARK_NO, MARK_NAME, REM)
VALUES ('2-100', 'TB100', 'ÊµãËØïÊ∏ÖÊ¥ÅÂ•óË£ÖÁâπÂæÅÁªÑ');
GO

-- 2. ÂàõÂª∫ÈôÑÂä†Â±ûÊÄßÔºà3‰∏™È¢úËâ≤ÁªÑÂêàÈÄâÈ°πÔºâ
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '486CÊöóÁ∫¢+7717CÂ≠îÈõÄËìù+7548CÂßúÈªÑ+10CÂÜ∑ÁÅ∞', 'È¢úËâ≤ÁªÑÂêà1');
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '225CÂ∏∏ËßÑÁé´Á∫¢+375CÂ∏∏ËßÑÁªø+298CÂ∏∏ËßÑËìù+424CÁÅ∞', 'È¢úËâ≤ÁªÑÂêà2');
INSERT INTO PRD_MARKS (MARK_NO, PRD_MARK, MARK_NAME)
VALUES ('2-100', '6CÂÜ∑ÁÅ∞+305CËìù+13-5304TPGÂç°ÂÖ∂+15-2216TCXÁ≤âËâ≤', 'È¢úËâ≤ÁªÑÂêà3');
GO

-- 3. ÂàõÂª∫3‰∏™SKU‰∫ßÂìÅ
-- ‰∏â‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.1111', 'TB100-Ê∏ÖÊ¥Å‰∏â‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());

-- Âõõ‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.2222', 'TB100-Ê∏ÖÊ¥ÅÂõõ‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:ÂèØÊãÜÂç∏Ê∞¥Ê°∂ÈÖç‰ª∂
D:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());

-- ÂÖ≠‰ª∂Â•ó
INSERT INTO PRDT (PRD_NO, NAME, SPC, MARK_NO, RECORD_DD)
VALUES ('C04.01.3333', 'TB100-Ê∏ÖÊ¥ÅÂÖ≠‰ª∂Â•ó', 'A:ÂÖ®Ê∂§ÁèäÁëöÁªíÂ∏ÉÂ§¥
B:ÂèåÈù¢Ê∏ÖÊ¥ÅÂà∑Â§¥
C:ÂèØÊãÜÂç∏Ê∞¥Ê°∂ÈÖç‰ª∂
D:360¬∞ÊóãËΩ¨ÊãñÊääÂ§¥
E:Â§áÁî®Ë∂ÖÁªÜÁ∫§Áª¥Â∏ÉÂ§¥
F:‰º∏Áº©ÈìÅÊùÜ(ÊÑèÊ†á)22&25√ó0.3√ó68-120/190g', '2-100', GETDATE());
GO

-- 4. È™åËØÅÊèíÂÖ•ÁªìÊûú
SELECT * FROM MARKS WHERE MARK_NO = '2-100';
SELECT * FROM PRD_MARKS WHERE MARK_NO = '2-100';
SELECT PRD_NO, NAME, MARK_NO FROM PRDT WHERE MARK_NO = '2-100';
GO
EOF

tsql -S MSSQL -U sa -P '1q!' <<'EOF'
USE DB_MP01;
GO
-- Êü•Áúã‰∫ßÂìÅÊï∞ÊçÆÊòØÂê¶‰π±Á†Å
SELECT PRD_NO, NAME, SPC FROM PRDT WHERE PRD_NO IN ('C04.01.1111', 'C04.01.2222', 'C04.01.3333');
GO
-- Êü•ÁúãÁâπÂæÅÁªÑ
SELECT * FROM MARKS WHERE MARK_NO = '2-100';
GO
-- Êü•ÁúãÈôÑÂä†Â±ûÊÄß
SELECT * FROM PRD_MARKS WHERE MARK_NO = '2-100';
GO
EOF